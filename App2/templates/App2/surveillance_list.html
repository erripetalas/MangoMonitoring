{% extends 'app2/base.html' %}
{% block title %}Surveillance Records{% endblock %}

{% block content %}
<a href="{% url 'App2:profile' %}" class="btn btn-secondary mb-3">← Back to Dashboard</a>

<h2>Surveillance Records</h2>

<!-- Filter Form -->
<form method="get" class="mb-3">
    <label for="severity">Filter by Severity:</label>
    <select name="severity" id="severity" onchange="this.form.submit()">
        <option value="">All</option>
        <option value="1" {% if severity_filter == '1' %}selected{% endif %}>Low</option>
        <option value="2" {% if severity_filter == '2' %}selected{% endif %}>Medium</option>
        <option value="3" {% if severity_filter == '3' %}selected{% endif %}>High</option>
        <option value="4" {% if severity_filter == '4' %}selected{% endif %}>Critical</option>
    </select>
</form>

  {% if surveillance_records %}
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Farm</th>
        <th>Pest</th>
        <th>Severity</th>
        <th>Count</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for record in surveillance_records %}
      <tr>
        <td>{{ record.farm.name }}</td>
        <td>{{ record.pest.name }}</td>
        <td>{{ record.severity }}</td>
        <td>{{ record.pest_count }}</td>
        <td>{{ record.date_observed }}</td>
        <td>
          <a href="{% url 'App2:surveillance-detail' record.pk %}" class="btn btn-sm btn-outline-primary">View</a>
          <a href="{% url 'App2:surveillance-update' record.pk %}" class="btn btn-sm btn-outline-secondary">Edit</a>
          <a href="{% url 'App2:surveillance-delete' record.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No records found for your filter criteria.</p>
  {% endif %}
  <a href="{% url 'App2:surveillance-list' %}" class="btn btn-secondary mt-3">← Back to Records</a>
</div>
{% endblock %}
