{% extends 'app2/base.html' %}
{% block title %}Surveillance Records{% endblock %}

{% block content %}
<h2>Surveillance Records</h2>

<!-- Filter Form -->
<form method="get" class="mb-3">
    <label for="severity">Filter by Severity:</label>
    <select name="severity" id="severity" onchange="this.form.submit()">
        <option value="">All</option>
        <option value="1" {% if severity_filter == '1' %}selected{% endif %}>Low</option>
        <option value="2" {% if severity_filter == '2' %}selected{% endif %}>Medium</option>
        <option value="3" {% if severity_filter == '3' %}selected{% endif %}>High</option>
        <option value="4" {% if severity_filter == '4' %}selected{% endif %}>Critical</option>
    </select>
</form>

<!-- Add Button -->
<a href="{% url 'App2:surveillance-create' %}" class="btn btn-success mb-2">+ Add Record</a>

<!-- Surveillance List -->
<ul>
    {% for record in surveillance_records %}
        <li>
    {{ record.date_observed }} –
    <strong>{{ record.pest.name }}</strong>
    <span 
        {% if record.severity == 1 %}
            style="color:green;"
        {% elif record.severity == 2 %}
            style="color:orange;"
        {% elif record.severity == 3 %}
            style="color:orangered;"
        {% else %}
            style="color:red;"
        {% endif %}
    >
        ({{ record.get_severity_display }})
    </span>
    –
    <a href="{% url 'App2:surveillance-detail' record.pk %}">View</a>
</li>

    {% empty %}
        <li>No surveillance records found for the selected filter.</li>
    {% endfor %}
</ul>
{% endblock %}
